# rpa-report-generator-capstone
report generator 3 
2023.12.05.

프로젝트명 
펀드 운용 보고서 자동화

현재 가지고 있는 보고서의 기간은 2021.07.29 ~ 2023.10.31
현재 가지고 있는 데이터의 기간은 2021.07.29 ~ 2023.10.30
하루 차이가 존재하여 실제 보고서의 값과 오차가 존재
하루 차이가 생각보다 큰 오차를 발생시키는듯 

1. 기간별 수익률 period_cumulative_return
펀드 : 8186 수정기준가 - (수정기준가 - 수정기준가iloc[:0]) / 수정기준가iloc[:0]
KOSPI : 8186 KOSPI지수 
KOSPI200 : 8186 KOSPI200지수
KOSDAQ : 8186 KOSDAQ지수
S&P500 : dataset-price-SPX

펀드의 기간에 따라 데이터프레임을 다르게 조정
2년을 넘지 못하면 1년까지만 나오게 하고 3년을 넘긴다면 3년도 나오게 하는 기능

추가할 내용 
option = 'krw' 'usd' 에 따라 환율을 적용한 수익률

2. 성능 평가 지표  investment_performance
누적수익률 : 8186 수정기준가 

연환산 수익률 : 기간수익률 *365/ 펀드 설정일 이후 현재까지 경과일수(기간수익률을 1년 단위로 환산한 수익률)= 누적수익률*365/날짜차이계산 
그러나 다른 보고서에서는 값이 다름
설정되지 1년이 경과하지 않은 펀드는 연환산 수익률이 표시되지 않는다 


변동성 : 변동성은 일일 수익률의 표준편차*(연간거래일수)**2 
이때 연간거래일수를 365로 계산 
그러나 연간거래일수는 일반적으로 252일로 계산 

샤프비율 : 연환산 수익률 - 무위험 수익률 /연환산 변동성
보고서의 샤프비율 어떻게 구했는지 확인 필요
무위험 수익률을 무엇으로 정했는지, 샤프비율은 연환산단위인지 누적단위인지 

Winning Ratio : 8186 전일대비 BM수익률과 다른 지수의 전일대비 차가 0인 날짜들은 쉬는 날이라 판단하고 이 날짜들을 필터링해야 하는 과정필요할듯 
거래 수가 아닌 날짜를 기준으로 함
이익 거래일 / 전체 거래일 * 100%
'전일대비수익률', '전일대비BM수익률(%)'칼럼의 경우 소수점 두번째자리까지만 나타나기에 0이 아닌 값을 0으로 나타내는 경우가 많았음
정확한 계산을 위해 데이터에 있는 '전일대비수익률', '전일대비BM수익률(%)'칼럼을 사용하지 않고
직접 일일 수익률을 계산하여 Winning Ratio 를 구했으나 보고서의 숫자와 차이가 많이 나옴.

실제 거래일만을 고려하기 위해 kospi지수에서 이전 kospi 지수와의 차이가 0인 날을 제외함.
수정기준가는 휴일에도 변동가능하기 때문에 kospi지수를 기준으로 함
이경우 winning ratio 가 펀드 53% 코스피 49% 라는 값이 나옴

값이 너무 차이가 심하여 혹시 휴일을 고려하지 않았던 것이 아닐까 하여 휴일을 고려하지 않은 전체기간에 대한 winning ratio를 구해봄
이 경우 winning ratio 가 펀드 60% 코스피 33% 로 나타남


MDD : MAX(최대치-최소치)/최대치
여기서 최대치는 기간중 최대 펀드 가치
최소치는 그 이후의 최소 펀드가치

3. 월간 수익률 monthly_return
펀드 : 8186
KOSPI : 8186
초과수익 : 펀드 - KOSPI
월말일을 기준으로 함 
뭘 초의 값들을 구할 필요 없음
2021년7월의 코스피의 경우 보고서에서는 7월28일의 지수를 기준으로 사용함.
그러나 데이터에서는 7월 28일의 값이 없기에 코드에서는 7월 29일의 지수를 적용

4. 펀드와 각종 지수에 대해 수익률 그래프 그 리기 